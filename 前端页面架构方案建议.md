# 前端页面架构方案建议

## 方案概述

基于 **Next.js (App Router) + antd + Supabase Auth** 技术栈，采用经典后台管理系统布局方案。

---

## 方案设计：经典后台管理系统布局

### 设计理念
- **传统稳定**: 采用经典的后台管理系统布局模式
- **快速实现**: 基于antd Layout组件快速搭建
- **易于维护**: 结构清晰，符合常见业务系统认知

### 登录/注册页面设计

#### 方案1：登录页面内切换（推荐）
```
┌─────────────────────────────────────┐
│                                     │
│    [Logo + 产品名称]                │
│                                     │
│    [登录] [注册]  ← Tab切换          │
│                                     │
│    ┌─────────────────────┐         │
│    │  邮箱输入框          │         │
│    └─────────────────────┘         │
│                                     │
│    ┌─────────────────────┐         │
│    │  密码输入框          │         │
│    └─────────────────────┘         │
│                                     │
│    (注册时显示)                      │
│    ┌─────────────────────┐         │
│    │  确认密码输入框       │         │
│    └─────────────────────┘         │
│                                     │
│    [ ] 记住我 (仅登录时显示)         │
│                                     │
│    ┌─────────────────────┐         │
│    │   登录/注册按钮       │         │
│    └─────────────────────┘         │
│                                     │
│    (登录时) 忘记密码？               │
│    使用Supabase Auth认证            │
└─────────────────────────────────────┘
```

#### 方案2：独立注册页面
- `/login` - 登录页面
- `/register` - 注册页面（表单包含：邮箱、密码、确认密码）

**特点**:
- 居中卡片式布局，背景渐变或纯色
- 支持邮箱/密码登录和注册
- 注册流程：邮箱验证（Supabase自动发送验证邮件）
- 简洁的表单验证（邮箱格式、密码强度、密码匹配）
- 响应式设计，移动端适配
- 使用antd Form组件，支持实时校验反馈

### 主框架布局设计
```
┌─────────────────────────────────────────────────────┐
│  [Logo]  小红书竞品笔记监控系统    [用户头像▼] 退出  │ ← 顶部导航栏 (60px)
├──────────┬──────────────────────────────────────────┤
│          │  ┌─ 面包屑导航                            │
│  侧边栏   │  ├─ 页面标题                             │
│  (200px) │  ├─ ┌────────────────────────────────┐  │
│          │  │  │                                │  │
│ 📊 首页  │  │  │     主内容区                    │  │
│          │  │  │      (表格/卡片/表单)            │  │
│ 📝 笔记管理│  │  │                                │  │
│   └─ 全部笔记│  │  │                                │  │
│   └─ 我的收藏│  │  └────────────────────────────────┘  │
│          │  └─ 分页/底部操作区                      │
│ 🏷️ 品牌管理│                                        │
│   └─ 品牌列表│                                        │
│   └─ 添加品牌│                                        │
│          │                                        │
│ 📈 分析报告│                                        │
│   └─ 数据概览│                                        │
│   └─ 趋势分析│                                        │
│          │                                        │
│ ⚙️ 设置  │                                        │
│   └─ 个人设置│                                        │
│   └─ 系统设置│                                        │
└──────────┴──────────────────────────────────────────┘
```

**特点**:
- 顶部固定导航栏：Logo、系统名称、用户信息
- 左侧固定侧边栏：主要功能菜单（支持收起/展开，收起时只显示图标）
  - **收起状态**：侧边栏宽度约80px，只显示菜单图标
  - **展开状态**：侧边栏宽度200px，显示完整菜单文字和图标
  - 通过顶部导航栏的菜单折叠按钮或侧边栏底部的折叠图标控制
- 主内容区：动态路由渲染页面内容
- 使用antd的Layout + Menu（SubMenu支持二级菜单）+ Breadcrumb组件
- 二级菜单通过antd Menu.SubMenu实现，支持展开/折叠动画
- 菜单高亮：根据当前路由自动高亮对应菜单项
- 菜单收起时：hover悬停显示完整菜单项文字提示（Tooltip）

### 技术实现要点

- **路由结构**: 
  - `/login` - 登录页（公开，支持Tab切换登录/注册）
  - `/register` - 注册页（可选，如果采用独立注册页面）
  - `/(dashboard)` - 主应用（需要认证）
    - `/dashboard` - 首页/仪表盘
    - `/dashboard/notes` - 笔记管理（全部笔记）
    - `/dashboard/notes/favorites` - 我的收藏
    - `/dashboard/brands` - 品牌列表
    - `/dashboard/brands/add` - 添加品牌
    - `/dashboard/reports` - 数据概览
    - `/dashboard/reports/trends` - 趋势分析
    - `/dashboard/settings` - 个人设置
    - `/dashboard/settings/system` - 系统设置

- **认证流程**:
  - 使用Supabase Auth进行用户认证和注册
  - **登录流程**：邮箱+密码 → Supabase Auth → Session存储
  - **注册流程**：邮箱+密码 → Supabase Auth → 发送验证邮件 → 邮箱验证 → 完成注册
  - 中间件保护路由（middleware.ts），未登录用户重定向到登录页
  - 登录状态存储在Supabase Session中，客户端和服务端都可访问

- **侧边栏菜单实现**:
  - 使用antd Menu组件的SubMenu功能实现二级菜单
  - 菜单配置化（menuItems配置数组），便于维护和扩展
  - 支持菜单图标、路由映射、权限控制
  - 自动根据当前路由高亮对应菜单项和父级菜单
  - 支持菜单折叠/展开动画
  - **菜单收起功能**：
    - 使用antd Layout的Sider组件的collapsed属性控制收起/展开
    - 收起状态（collapsed=true）：宽度80px，只显示图标
    - 展开状态（collapsed=false）：宽度200px，显示图标+文字
    - 收起时，hover图标显示Tooltip提示完整菜单名称
    - 二级菜单收起时，点击图标可展开弹出式子菜单（Popover）

- **组件结构**:
```
app/
├── (auth)/
│   ├── login/
│   │   └── page.tsx          # 登录页面（Tab切换登录/注册）
│   └── register/
│       └── page.tsx          # 注册页面（可选，如果独立页面）
├── (dashboard)/
│   ├── layout.tsx            # 主框架布局（包含侧边栏菜单）
│   ├── page.tsx              # 首页
│   ├── notes/
│   │   ├── page.tsx          # 全部笔记
│   │   └── favorites/
│   │       └── page.tsx      # 我的收藏
│   ├── brands/
│   │   ├── page.tsx          # 品牌列表
│   │   └── add/
│   │       └── page.tsx      # 添加品牌
│   ├── reports/
│   │   ├── page.tsx          # 数据概览
│   │   └── trends/
│   │       └── page.tsx      # 趋势分析
│   └── settings/
│       ├── page.tsx          # 个人设置
│       └── system/
│           └── page.tsx      # 系统设置
├── components/
│   └── layout/
│       └── SidebarMenu.tsx   # 侧边栏菜单组件（支持二级菜单）
└── middleware.ts             # 路由保护
```

---

## 技术栈配置

### 技术选型：
- **Next.js 14+** (App Router)
- **antd 5.x** (最新版本，支持Menu.SubMenu二级菜单)
- **Supabase Client** (认证和数据库)
- **TypeScript** (类型安全)
- **Tailwind CSS** (可选，用于样式定制)

### 环境变量配置：
```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
GEMINI_API_KEY=your_gemini_key
```

---

## 关键设计确认

### ✅ 登录/注册流程确认
**已确认采用方案1**：登录页面内Tab切换登录/注册
- 单页面内通过Tab标签切换登录/注册表单
- 登录时显示：邮箱、密码、记住我、忘记密码链接
- 注册时显示：邮箱、密码、确认密码
- 使用antd的Tabs组件实现切换

### ✅ 侧边栏菜单功能确认
**已确认需求**：菜单支持收起/展开功能
- **展开状态**：宽度200px，显示图标+文字+二级菜单
- **收起状态**：宽度80px，只显示图标
- 收起时hover图标显示Tooltip提示菜单名称
- 收起时点击有二级菜单的图标，弹出子菜单（Popover）

### 二级菜单示例
菜单结构示例（可根据实际需求调整）：
```
📊 首页
📝 笔记管理
   └─ 全部笔记
   └─ 我的收藏
🏷️ 品牌管理
   └─ 品牌列表
   └─ 添加品牌
📈 分析报告
   └─ 数据概览
   └─ 趋势分析
⚙️ 设置
   └─ 个人设置
   └─ 系统设置
```

---

## 下一步行动

✅ **方案已确认**：
1. ✅ 登录/注册：方案1（登录页面内Tab切换）
2. ✅ 侧边栏菜单：支持收起/展开（收起时只显示图标）

**准备开始搭建**：
1. 项目基础结构和配置文件
2. 登录/注册页面（Tab切换方案）
3. 主框架布局（包含可收起的二级菜单侧边栏）
4. 路由保护中间件
5. Supabase认证集成（登录+注册）

