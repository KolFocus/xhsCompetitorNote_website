# 技术方案

## 前端技术栈

### 核心框架
- **Next.js 14+ (App Router)**: 
  - 使用最新的App Router架构
  - 支持Server Components和Client Components
  - 自动代码分割和优化
  - 内置API路由支持

### UI组件库
- **antd 5.x**: 
  - 企业级UI组件库
  - 支持二级菜单的Menu组件
  - 丰富的表单、表格、数据展示组件
  - 完整的TypeScript类型定义

### 状态管理
- **React Hooks**: 使用useState、useEffect等内置Hooks
- **Context API**: 用于全局状态管理（如用户认证状态）
- **Server Components**: 利用Next.js Server Components减少客户端状态

### 样式方案
- **CSS Modules**: 组件级样式隔离
- **antd内置样式**: 使用antd的设计系统
- **Tailwind CSS**: 可选，用于快速样式定制

## 后端技术栈

### 数据库
- **Supabase PostgreSQL**: 
  - 完全托管的PostgreSQL数据库
  - 支持SQL查询和事务
  - 实时数据订阅（Realtime）
  - Row Level Security (RLS) 数据安全

### 认证系统
- **Supabase Auth**:
  - 邮箱密码认证
  - JWT Token管理
  - Session自动管理
  - 用户注册和邮箱验证

### API服务
- **Supabase REST API**: 自动生成的RESTful API
- **Supabase Edge Functions**: 服务端函数（Deno运行时）
  - 用于复杂业务逻辑
  - AI分析功能调用

### 存储服务
- **Supabase Storage**: 
  - 文件存储服务
  - CDN加速
  - 图片处理

## AI服务集成

### Google Gemini API
- **用途**: 笔记内容分析和分类
- **功能**:
  - 内容类别判别
  - 单品名称识别
  - 内容质量评估
- **调用方式**: 通过Supabase Edge Functions调用，确保API Key安全

## 部署方案

### 前端部署 (Vercel)
- **优势**:
  - 自动CI/CD
  - 全球CDN加速
  - 零配置部署
  - 自动HTTPS
- **环境变量**: 在Vercel控制台配置

### 后端服务 (Supabase)
- **数据库**: Supabase Cloud托管
- **Edge Functions**: Supabase Edge Functions平台
- **认证**: Supabase Auth服务

## 架构设计

### 页面架构
- **认证页面**: `/login` - 登录/注册（Tab切换）
- **主应用**: `/(dashboard)` - 需要认证保护
  - 布局组件：顶部导航 + 侧边栏菜单
  - 路由保护：middleware.ts中间件

### 数据流
1. 爬虫系统 → Supabase数据库（直接写入）
2. 前端应用 → Supabase REST API（读取数据）
3. 用户操作 → Supabase Auth（认证）
4. AI分析 → Edge Functions → Gemini API → 返回结果

### 安全策略
- **路由保护**: Next.js middleware检查认证状态
- **数据安全**: Supabase RLS策略控制数据访问
- **API安全**: Supabase JWT Token认证
- **环境变量**: 敏感信息通过环境变量配置

## 性能优化

### 前端优化
- Next.js自动代码分割
- Server Components减少客户端JavaScript
- 图片优化（Next.js Image组件）
- 静态生成（Static Generation）和增量静态再生（ISR）

### 数据库优化
- 合理设置索引
- 查询优化
- 数据分页
- 缓存策略

## 开发工具

- **TypeScript**: 类型安全
- **ESLint**: 代码质量检查
- **Prettier**: 代码格式化
- **Git**: 版本控制

