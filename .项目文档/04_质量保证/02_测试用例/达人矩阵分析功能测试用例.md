---
标题: 达人矩阵分析功能测试用例
Owner: 测试（TBD）
状态: 已批准
Canonical: true
Links:
  业务规则: ../../../05_核心业务逻辑/达人矩阵统计业务逻辑.md
  产品规格: ../../../01_产品定义/02_功能规格/达人矩阵属性分析功能规格.md
  UI规格: ../../../02_UI设计/02_原型与线框图/达人矩阵分析页面设计.md
  API规格: ../../../03_技术实现/05_API接口契约/API_达人矩阵分析接口.md
---
# 达人矩阵分析功能测试用例

> 统计口径以“业务规则”为准；本用例不重复定义算法，仅校验与口径一致的结果与交互。

## 概述

本文档描述达人矩阵属性分析功能的测试用例，包括功能测试、边界测试、异常测试等。

---

## 1. 功能测试

### 1.1 查看达人矩阵分析

**测试用例 TC-BM-001**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有至少一条有效笔记

**测试步骤**：
1. 进入报告详情页
2. 查看"达人矩阵属性分析"板块

**预期结果**：
- 显示达人矩阵统计表格
- 表格包含知名KOL层和自定义层级
- 显示总计行
- 所有数据正确显示

---

### 1.2 配置层级

**测试用例 TC-BM-002**

**前置条件**：
- 用户已登录
- 存在至少一个报告

**测试步骤**：
1. 点击"配置"按钮
2. 查看配置弹窗
3. 查看知名KOL层（应显示为不可编辑）
4. 查看自定义层级列表

**预期结果**：
- 配置弹窗正常打开
- 知名KOL层显示为不可编辑状态
- 自定义层级列表正确显示
- 如果存在自定义配置，显示自定义配置；否则显示系统默认配置

---

### 1.3 添加层级

**测试用例 TC-BM-003**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 配置弹窗已打开
- 自定义层级数量 < 10

**测试步骤**：
1. 点击"+ 添加层级"按钮
2. 输入层级名称和粉丝数范围
3. 点击"保存"

**预期结果**：
- 新层级添加到列表末尾
- 新层级进入编辑状态
- 可以正常输入层级名称和粉丝数范围

---

### 1.4 编辑层级

**测试用例 TC-BM-004**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 配置弹窗已打开
- 存在至少一个自定义层级

**测试步骤**：
1. 点击某个层级的"编辑"按钮
2. 修改层级名称和粉丝数范围
3. 点击"保存"

**预期结果**：
- 层级进入编辑状态
- 可以正常修改层级名称和粉丝数范围
- 修改后保存成功

---

### 1.5 删除层级

**测试用例 TC-BM-005**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 配置弹窗已打开
- 存在至少2个自定义层级

**测试步骤**：
1. 点击某个层级的"删除"按钮
2. 确认删除

**预期结果**：
- 点击即删除（无二次确认）
- 删除后其它行 `minFans` 不变，区间自动重算并自然衔接
- 如果只剩1个自定义层级，删除按钮禁用

---

### 1.6 保存配置

**测试用例 TC-BM-006**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 配置弹窗已打开
- 配置已修改

**测试步骤**：
1. 点击"保存"按钮

**预期结果**：
- 配置保存成功
- 弹窗关闭
- 统计数据自动刷新

---

### 1.7 重置配置

**测试用例 TC-BM-007**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 配置弹窗已打开
- 配置已修改

**测试步骤**：
1. 点击"重置"按钮

**预期结果**：
- 配置恢复为系统默认配置
- 弹窗不关闭
- 配置未保存到数据库

---

### 1.8 导出Excel

**测试用例 TC-BM-028**

**前置条件**：
- 用户已登录
- 存在至少一个报告且已加载统计数据

**测试步骤**：
1. 点击“导出Excel”按钮
2. 下载完成后打开文件

**预期结果**：
- 导出成功，无错误提示
- Excel 包含“汇总”与“明细”两张表
- 汇总表包含：层级名称、粉丝区间、达人数量、达人占比、平均粉丝数、总互动量、互动量占比、分享量、分享占比、笔记数量、笔记占比、总计行
- 明细表包含：用于复核的明细数据（含层级匹配结果）
- 数字格式与页面显示一致（千分位/百分比）

---

## 2. 数据统计测试

### 2.1 达人数量统计

**测试用例 TC-BM-008**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有多条笔记，包含多个达人

**测试步骤**：
1. 查看达人矩阵统计表格
2. 检查各层级的达人数量

**预期结果**：
- 达人数量正确统计（按 `BloggerId` 去重）
- 同一达人在多个层级中只计入第一个匹配的层级
- 知名KOL层的达人不会出现在其他层级中

---

### 2.2 达人占比统计

**测试用例 TC-BM-009**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有多条笔记

**测试步骤**：
1. 查看达人矩阵统计表格
2. 检查各层级的达人占比

**预期结果**：
- 达人占比正确计算（该层级达人数量 / 分层分母达人总数 × 100%），其中分层分母仅包含“知名KOL + 所有自定义层级”的不重复达人总数，未分层达人不计入分母
- 所有分层行的达人占比之和 = 100%
- 总计行的达人占比为100.0%

---

### 2.3 平均粉丝数统计

**测试用例 TC-BM-010**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有多条笔记

**测试步骤**：
1. 查看达人矩阵统计表格
2. 检查各层级的平均粉丝数

**预期结果**：
- 平均粉丝数正确计算（该层级所有达人的粉丝数总和 / 该层级达人数量）
- 按达人去重后计算平均值（避免同一达人的多条笔记影响平均值）

---

### 2.4 总互动量统计

**测试用例 TC-BM-011**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有多条笔记

**测试步骤**：
1. 查看达人矩阵统计表格
2. 检查各层级的总互动量

**预期结果**：
- 总互动量正确计算（该层级所有笔记的互动量总和，不含分享）
- 互动量 = 点赞数 + 收藏数 + 评论数
- 不去重，统计所有笔记记录

---

### 2.5 互动量占比统计

**测试用例 TC-BM-012**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有多条笔记

**测试步骤**：
1. 查看达人矩阵统计表格
2. 检查各层级的互动量占比

**预期结果**：
- 互动量占比正确计算（该层级总互动量 / 分层分母总互动量 × 100%），其中分层分母仅包含“知名KOL + 所有自定义层级”的互动量（不含分享），未分层达人对应笔记的互动量不计入分母
- 所有分层行的互动量占比之和 = 100%
- 总计行的互动量占比为100.0%

---

### 2.6 笔记数量统计

**测试用例 TC-BM-013**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有多条笔记

**测试步骤**：
1. 查看达人矩阵统计表格
2. 检查各层级的笔记数量

**预期结果**：
- 笔记数量正确统计（不去重，统计所有笔记记录）
- 同一达人的多条笔记都应计入

---

### 2.7 笔记占比统计

**测试用例 TC-BM-014**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有多条笔记

**测试步骤**：
1. 查看达人矩阵统计表格
2. 检查各层级的笔记占比

**预期结果**：
- 笔记占比正确计算（该层级笔记数量 / 所有层级笔记总数 × 100%）
- 所有层级的笔记占比之和 = 100%
- 总计行的笔记占比为100.0%

---

### 2.8 总计行统计

**测试用例 TC-BM-015**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有多条笔记

**测试步骤**：
1. 查看达人矩阵统计表格
2. 检查总计行的数据

**预期结果**：
- 总计行统计的是报告中的所有有效笔记，不是各层级数据的简单相加
- 粉丝数范围显示报告所有有效笔记对应的不重复达人中，粉丝数的最小值和最大值
- 达人数量、总互动量、笔记数量正确统计
- 所有占比列显示100.0%

---

### 2.9 分享量与分享占比统计

**测试用例 TC-BM-029**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有多条笔记

**测试步骤**：
1. 查看达人矩阵统计表格
2. 检查各层级的分享量与分享占比

**预期结果**：
- 分享量为该层级所有笔记的分享数之和
- 分享占比 = 该层级分享量 / 报告所有有效笔记分享量之和 × 100%
- 总计行的分享占比为100.0%

---

## 3. 配置验证测试

### 3.1 层级名称验证

**测试用例 TC-BM-016**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 配置弹窗已打开

**测试步骤**：
1. 尝试保存空层级名称
2. 尝试保存超过20个字符的层级名称
3. 尝试保存重复的层级名称

**预期结果**：
- 空层级名称：显示错误提示"层级名称不能为空"
- 超过20个字符：显示错误提示"层级名称不能超过20个字符"
- 重复的层级名称：显示错误提示"层级名称已存在，请使用其他名称"
- 保存按钮禁用

---

### 3.2 粉丝数范围验证

**测试用例 TC-BM-017**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 配置弹窗已打开

**测试步骤**：
1. 尝试保存 `minFans < 0` 的配置
2. 尝试保存 `maxFans <= minFans` 的配置
3. 尝试保存范围重叠的配置
4. 尝试保存范围不连续的配置

**预期结果**：
- `minFans < 0`：显示错误提示"最小粉丝数不能小于0"
- `maxFans <= minFans`：显示错误提示"最大值必须大于最小值"
- 范围重叠：显示错误提示"粉丝数范围与其他层级重叠，请调整"
- 范围不连续：显示错误提示"层级之间不能留空，请确保所有粉丝数范围连续覆盖"
- 保存按钮禁用

---

### 3.3 层级数量验证

**测试用例 TC-BM-018**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 配置弹窗已打开

**测试步骤**：
1. 尝试删除最后一个自定义层级
2. 尝试添加超过10个自定义层级

**预期结果**：
- 删除最后一个自定义层级：删除按钮禁用
- 添加超过10个自定义层级：显示错误提示"最多支持10个自定义层级"

---

## 4. 边界测试

### 4.1 空数据测试

**测试用例 TC-BM-019**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中没有有效笔记

**测试步骤**：
1. 查看达人矩阵统计表格

**预期结果**：
- 显示空状态提示："暂无数据"或"该报告暂无有效笔记"
- 表格不显示数据行

---

### 4.2 大量数据测试

**测试用例 TC-BM-020**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有大量笔记（>5000条）

**测试步骤**：
1. 查看达人矩阵统计表格
2. 检查计算性能

**预期结果**：
- 统计数据正确计算
- 计算时间 < 5秒
- 页面不卡顿

---

### 4.3 单达人单笔记测试

**测试用例 TC-BM-021**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中只有一条笔记，对应一个达人

**测试步骤**：
1. 查看达人矩阵统计表格

**预期结果**：
- 统计数据正确显示
- 达人数量为1
- 笔记数量为1
- 占比为100.0%

---

## 5. 异常测试

### 5.1 网络异常测试

**测试用例 TC-BM-022**

**前置条件**：
- 用户已登录
- 存在至少一个报告

**测试步骤**：
1. 断开网络连接
2. 尝试加载达人矩阵统计数据
3. 尝试保存配置

**预期结果**：
- 显示错误提示："网络错误，请稍后重试"
- 提供重试按钮

---

### 5.2 权限异常测试

**测试用例 TC-BM-023**

**前置条件**：
- 用户A已登录
- 用户A创建了报告A
- 用户B已登录

**测试步骤**：
1. 用户B尝试访问用户A的报告的达人矩阵配置

**预期结果**：
- 返回403错误或404错误
- 显示错误提示："无权访问"或"报告不存在"

---

### 5.3 数据异常测试

**测试用例 TC-BM-024**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 报告中有笔记，但笔记的达人信息缺失

**测试步骤**：
1. 查看达人矩阵统计表格

**预期结果**：
- 跳过达人信息缺失的笔记
- 不影响其他统计
- 统计数据正确显示

---

## 6. 集成测试

### 6.1 报告数据更新测试

**测试用例 TC-BM-025**

**前置条件**：
- 用户已登录
- 存在至少一个报告
- 达人矩阵统计数据已显示

**测试步骤**：
1. 追加笔记到报告
2. 忽略笔记
3. 删除笔记
4. 恢复笔记

**预期结果**：
- 每次操作后，达人矩阵统计数据自动刷新
- 统计数据正确更新

---

### 6.2 切换报告测试

**测试用例 TC-BM-026**

**前置条件**：
- 用户已登录
- 存在多个报告
- 不同报告有不同的配置

**测试步骤**：
1. 切换到报告A，查看达人矩阵统计数据
2. 切换到报告B，查看达人矩阵统计数据

**预期结果**：
- 切换报告后，自动加载对应报告的配置
- 统计数据正确显示
- 配置正确切换

---

## 7. 性能测试

### 7.1 响应时间测试

**测试用例 TC-BM-027**

**前置条件**：
- 用户已登录
- 存在至少一个报告

**测试步骤**：
1. 测量配置加载时间
2. 测量统计数据计算时间
3. 测量配置保存时间

**预期结果**：
- 配置加载时间 < 500ms
- 统计数据计算时间 < 2s（1000条笔记以内）
- 配置保存时间 < 1s

---

## 8. 兼容性测试

### 8.1 浏览器兼容性测试

**测试用例 TC-BM-028**

**前置条件**：
- 用户已登录
- 存在至少一个报告

**测试步骤**：
1. 在Chrome浏览器中测试
2. 在Firefox浏览器中测试
3. 在Safari浏览器中测试
4. 在Edge浏览器中测试

**预期结果**：
- 所有浏览器中功能正常
- UI显示正常
- 交互正常

---

## 9. 测试数据准备

### 9.1 测试数据要求

1. **报告数据**：
   - 至少创建3个报告
   - 每个报告包含不同数量的笔记（0条、1条、多条）

2. **笔记数据**：
   - 包含不同粉丝数的达人
   - 包含官方认证和非官方认证的达人
   - 包含不同互动量的笔记

3. **配置数据**：
   - 创建自定义配置
   - 测试不同数量的层级（1个、多个、10个）

---

## 10. 测试环境

### 10.1 测试环境要求

- **开发环境**：本地开发环境
- **测试环境**：测试服务器环境
- **数据库**：测试数据库（包含测试数据）

### 10.2 测试工具

- **浏览器**：Chrome DevTools
- **API测试**：Postman 或 curl
- **性能测试**：Chrome DevTools Performance

---

## 11. 测试执行计划

### 11.1 测试阶段

1. **单元测试**：测试各个函数和组件
2. **集成测试**：测试功能集成
3. **系统测试**：测试完整功能流程
4. **验收测试**：用户验收测试

### 11.2 测试优先级

- **P0**：核心功能测试（查看、配置、统计）
- **P1**：边界测试、异常测试
- **P2**：性能测试、兼容性测试

---

## 12. 缺陷管理

### 12.1 缺陷分类

- **严重**：功能无法使用
- **一般**：功能可用但有缺陷
- **轻微**：UI或交互问题

### 12.2 缺陷跟踪

- 使用缺陷跟踪系统记录缺陷
- 每个缺陷包含：标题、描述、复现步骤、预期结果、实际结果、优先级、状态

